
#
# Copyright 2014 The Trustees of Indiana University
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or areed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# -----------------------------------------------------------------
#
# Project:		Komadu Provenance Messaging Client
# File:			Notification.java query.java
# Description:	README for Komadu Service Client (Non-Webservice Client)
#
# -----------------------------------------------------------------
# 

$ Author: Quan Zhou (quzhou@indiana.edu) $
======================================================================================
README for Komadu Service Client (Non-Webservice Client)
======================================================================================
This README is on how to use Komadu Service Client when Komadu Server is hosted as standalone server using RabbitMQ for messaging.

==========================
1 Configure and Build Komadu Service Client
==========================

cd ${Komadu-Client-Core}

Edit build.properties:
Point the komadu.client.properties to a valid properties path. Default is ${Komadu-Client-Core}/config/komadu.properties

ant

Client API can be found in ${Komadu-Client-Core}/build/lib/komadu-client.jar
Java Doc can be found under ${Komadu-Client-Core}/doc

==========================
2 Use Komadu Service Client
==========================

Edit ${Komadu-Client-Core}/config/komadu.properties properly. See Komadu Server README for detailed information.

We offer 2 options to use Komadu Service Client. 
2.1) We provide two sets of commands to ingest, query and test against Komadu Server: Linux shell scripts, and ant command.

	a) Notification Ingest:
	./bin/sendNotification.sh config/komadu.properties ${path_to_notification_xml_file}
	or 
	ant sendNotification -Dnotification=${path_to_notification_xml_file}
	
	b) Query:
	./bin/query.sh config/komadu.properties ${path_to_query_xml_file}
	or
	ant query -Dquery=${path_to_query_xml_file}
	
	c) To run any main method in the Komadu client package
	./bin/KomaduRun.sh <Main Class> <Arguments>
	or,
	ant run -DrunClass=< Main Class > -DrunArgs=î<Arguments>î

2.2) Write your own application and invoke Komadu Service Client API inside Komadu-client.jar
API Java Doc can be found under ${Komadu-Client-Core}/doc

==========================
3 Komadu Service Client Use Cases
==========================

3.1) Use Cases through command line:

	There are 3 sample notification and 1 query files under sample/ directory. 
	
	*Send these notifications using the following command:	
	./bin/sendNotification.sh config/Komadu.properties ${Komadu-Client-Core}/samples/notification/sendingResponse.xml	
	./bin/sendNotification.sh config/Komadu.properties ${Komadu-Client-Core}/samples/notification/sendingResponseStatus.xml	
	./bin/sendNotification.sh config/Komadu.properties ${Komadu-Client-Core}/samples/notification/serviceInvoked.xml
	or,
	ant sendNotification -Dnotification=${Komadu-Client-Core}/samples/notification/sendingResponse.xml 
	ant sendNotification -Dnotification=${Komadu-Client-Core}/samples/notification/sendingResponseStatus.xml
	ant sendNotification -Dnotification=${Komadu-Client-Core}/samples/notification/serviceInvoked.xml
	
	*Query:	
	./bin/query.sh config/Komadu.properties ${Komadu-Client-Core}/samples/notification/getWorkflowGraphRequest.xml	
	or,	
	ant query -Dquery=${Komadu-Client-Core}/samples/notification/getWorkflowGraphRequest.xml


3.2) Use Cases through Komadu Service Client API calls
There are 3 sample code for sending 3 different types of notifications to the Komadu Server, under test/ directory. These sample code can be compiled and run through command line.

	./bin/KomaduRun.sh <Main Class> <Arguments>
	or,	
	ant run -DrunClass=<Main Class> -DrunArgs=<Arguments>

3.3) A complete set of notification xml files for a sample workflow can be found here,
	 
	 ${Komadu-Client-Core}/samples/sampleWorkflow1/notification
	 
	 Run script to ingest all the notifications,
	 
	 ${Komadu-Client-Core}/samples/sampleWorkflow1/notification/ingestWorkflow.sh
	 
	 Query file can be found here,
	 
	 ${Komadu-Client-Core}/samples/sampleWorkflow1/query
